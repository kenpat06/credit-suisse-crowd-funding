# Stacktrace

*THIS IS RESOLVED* - 14 September 2016 - See Github issues on [Finatra 349](https://github.com/twitter/finatra/issues/349) and also [Finatra 350](https://github.com/twitter/finatra/issues/350) 

Try as hard as I might, I failed to get Finatra's feature test capabilities working 

The `CrowdSourceServerFeatureTest` test produced a stacktrace

    "C:\Program Files\Java\jdk1.8.0_102\bin\java" -Didea.launcher.port=7533 "-Didea.launcher.bin.path=C:\Program Files (x86)\JetBrains\IntelliJ IDEA 2016.2\bin" -Dfile.encoding=UTF-8 -classpath "C:\Users\peter\.IntelliJIdea2016.2\config\plugins\Scala\lib\scala-plugin-runners.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\deploy.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\access-bridge-64.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\cldrdata.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\dnsns.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\jaccess.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\jfxrt.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\localedata.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\nashorn.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\sunec.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\sunmscapi.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\sunpkcs11.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\ext\zipfs.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\javaws.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\jce.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\jfr.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\jfxswt.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\management-agent.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\plugin.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\resources.jar;C:\Program Files\Java\jdk1.8.0_102\jre\lib\rt.jar;C:\Users\peter\Documents\IdeaProjects\clients\interviews\credit-suisse-crowdfunding-loans\target\scala-2.11\test-classes;C:\Users\peter\Documents\IdeaProjects\clients\interviews\credit-suisse-crowdfunding-loans\target\scala-2.11\classes;C:\Users\peter\.ivy2\cache\junit\junit\jars\junit-4.12.jar;C:\Users\peter\.ivy2\cache\com.google.inject.extensions\guice-testlib\jars\guice-testlib-4.0.jar;C:\Users\peter\.ivy2\cache\ch.qos.logback\logback-core\jars\logback-core-1.1.7.jar;C:\Users\peter\.ivy2\cache\ch.qos.logback\logback-classic\jars\logback-classic-1.1.7.jar;C:\Users\peter\.ivy2\cache\org.slf4j\slf4j-api\jars\slf4j-api-1.7.21.jar;C:\Users\peter\.ivy2\cache\org.slf4j\log4j-over-slf4j\jars\log4j-over-slf4j-1.7.21.jar;C:\Users\peter\.ivy2\cache\org.slf4j\jul-to-slf4j\jars\jul-to-slf4j-1.7.21.jar;C:\Users\peter\.ivy2\cache\org.slf4j\jcl-over-slf4j\jars\jcl-over-slf4j-1.7.21.jar;C:\Users\peter\.ivy2\cache\org.scala-lang.modules\scala-xml_2.11\bundles\scala-xml_2.11-1.0.5.jar;C:\Users\peter\.ivy2\cache\org.scala-lang\scalap\jars\scalap-2.11.8.jar;C:\Users\peter\.ivy2\cache\org.joda\joda-convert\jars\joda-convert-1.2.jar;C:\Users\peter\.ivy2\cache\org.clapper\grizzled-slf4j_2.11\jars\grizzled-slf4j_2.11-1.0.2.jar;C:\Users\peter\.ivy2\cache\org.apache.thrift\libthrift\jars\libthrift-0.5.0-1.jar;C:\Users\peter\.ivy2\cache\net.codingwell\scala-guice_2.11\jars\scala-guice_2.11-4.0.0.jar;C:\Users\peter\.ivy2\cache\joda-time\joda-time\jars\joda-time-2.5.jar;C:\Users\peter\.ivy2\cache\javax.servlet\servlet-api\jars\servlet-api-2.5.jar;C:\Users\peter\.ivy2\cache\javax.inject\javax.inject\jars\javax.inject-1.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-transport\jars\netty-transport-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-resolver\jars\netty-resolver-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-handler-proxy\jars\netty-handler-proxy-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-handler\jars\netty-handler-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-common\jars\netty-common-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-codec-socks\jars\netty-codec-socks-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-codec-http\jars\netty-codec-http-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-codec\jars\netty-codec-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\io.netty\netty-buffer\jars\netty-buffer-4.1.4.Final.jar;C:\Users\peter\.ivy2\cache\commons-io\commons-io\jars\commons-io-2.4.jar;C:\Users\peter\.ivy2\cache\commons-fileupload\commons-fileupload\jars\commons-fileupload-1.3.1.jar;C:\Users\peter\.ivy2\cache\com.twitter.finatra\finatra-scalap-compiler-deps_2.11\jars\finatra-scalap-compiler-deps_2.11-2.0.0.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\util-system-mocks\jars\util-system-mocks-0.0.103.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\util-sampler\jars\util-sampler-0.0.77.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\util-executor-service-shutdown\jars\util-executor-service-shutdown-0.0.66.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\util\jars\util-0.0.120.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\stats-util\jars\stats-util-0.0.58.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\stats-provider\jars\stats-provider-0.0.92.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\stats\jars\stats-0.0.114.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\stat-registry\jars\stat-registry-0.0.57.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\stat\jars\stat-0.0.72.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\quantity\jars\quantity-0.0.98.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\metrics\jars\metrics-0.0.37.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\jdk-logging\jars\jdk-logging-0.0.79.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\collections\jars\collections-0.0.109.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\base\jars\base-0.0.114.jar;C:\Users\peter\.ivy2\cache\com.twitter.common\application-action\jars\application-action-0.0.89.jar;C:\Users\peter\.ivy2\cache\com.twitter\jsr166e\jars\jsr166e-1.0.0.jar;C:\Users\peter\.ivy2\cache\com.thoughtworks.paranamer\paranamer\jars\paranamer-2.6.jar;C:\Users\peter\.ivy2\cache\com.google.inject.extensions\guice-multibindings\jars\guice-multibindings-4.0.jar;C:\Users\peter\.ivy2\cache\com.google.inject.extensions\guice-assistedinject\jars\guice-assistedinject-4.0.jar;C:\Users\peter\.ivy2\cache\com.google.inject\guice\jars\guice-4.0.jar;C:\Users\peter\.ivy2\cache\com.github.spullara.mustache.java\compiler\bundles\compiler-0.8.18.jar;C:\Users\peter\.ivy2\cache\com.github.nscala-time\nscala-time_2.11\jars\nscala-time_2.11-1.6.0.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.module\jackson-module-scala_2.11\bundles\jackson-module-scala_2.11-2.6.5.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.module\jackson-module-paranamer\bundles\jackson-module-paranamer-2.6.5.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.datatype\jackson-datatype-joda\bundles\jackson-datatype-joda-2.6.5.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.core\jackson-databind\bundles\jackson-databind-2.6.5.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.core\jackson-core\bundles\jackson-core-2.6.5.jar;C:\Users\peter\.ivy2\cache\com.fasterxml.jackson.core\jackson-annotations\bundles\jackson-annotations-2.6.5.jar;C:\Users\peter\.ivy2\cache\aopalliance\aopalliance\jars\aopalliance-1.0.jar;C:\Users\peter\.ivy2\cache\org.scalatest\scalatest_2.11\bundles\scalatest_2.11-3.0.0.jar;C:\Users\peter\.ivy2\cache\org.scalactic\scalactic_2.11\bundles\scalactic_2.11-3.0.0.jar;C:\Users\peter\.ivy2\cache\org.scala-lang\scala-reflect\jars\scala-reflect-2.11.8.jar;C:\Users\peter\.ivy2\cache\org.scala-lang\scala-library\jars\scala-library-2.11.8.jar;C:\Users\peter\.ivy2\cache\org.mockito\mockito-all\jars\mockito-all-1.10.8.jar;C:\Users\peter\.ivy2\cache\org.hamcrest\hamcrest-core\jars\hamcrest-core-1.3.jar;C:\Users\peter\.ivy2\cache\com.github.ben-manes.caffeine\caffeine\jars\caffeine-2.3.0.jar;C:\Users\peter\.ivy2\cache\com.google.code.findbugs\jsr305\jars\jsr305-2.0.1.jar;C:\Users\peter\.ivy2\cache\com.google.guava\guava\bundles\guava-16.0.1.jar;C:\Users\peter\.ivy2\cache\commons-lang\commons-lang\jars\commons-lang-2.6.jar;C:\Users\peter\.ivy2\cache\io.netty\netty\bundles\netty-3.10.1.Final.jar;C:\Users\peter\.ivy2\cache\org.scala-lang.modules\scala-parser-combinators_2.11\bundles\scala-parser-combinators_2.11-1.0.4.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-core_2.11\jars\finagle-core_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-http_2.11\jars\finagle-http_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-mux_2.11\jars\finagle-mux_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-netty4-http_2.11\jars\finagle-netty4-http_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-netty4_2.11\jars\finagle-netty4_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-stats_2.11\jars\finagle-stats_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-thrift_2.11\jars\finagle-thrift_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-toggle_2.11\jars\finagle-toggle_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finagle-zipkin-core_2.11\jars\finagle-zipkin-core_2.11-6.38.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finatra-http_2.11\jars\finatra-http_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finatra-http_2.11\jars\finatra-http_2.11-2.4.0-tests.jar;C:\Users\peter\.ivy2\cache\com.twitter\finatra-jackson_2.11\jars\finatra-jackson_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finatra-slf4j_2.11\jars\finatra-slf4j_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\finatra-utils_2.11\jars\finatra-utils_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-app_2.11\jars\inject-app_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-app_2.11\jars\inject-app_2.11-2.4.0-tests.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-core_2.11\jars\inject-core_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-core_2.11\jars\inject-core_2.11-2.4.0-tests.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-modules_2.11\jars\inject-modules_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-modules_2.11\jars\inject-modules_2.11-2.4.0-tests.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-request-scope_2.11\jars\inject-request-scope_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-server_2.11\jars\inject-server_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-server_2.11\jars\inject-server_2.11-2.4.0-tests.jar;C:\Users\peter\.ivy2\cache\com.twitter\inject-utils_2.11\jars\inject-utils_2.11-2.4.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\scrooge-core_2.11\jars\scrooge-core_2.11-4.10.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\twitter-server_2.11\jars\twitter-server_2.11-1.23.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-app_2.11\jars\util-app_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-cache_2.11\jars\util-cache_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-codec_2.11\jars\util-codec_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-collection_2.11\jars\util-collection_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-core_2.11\jars\util-core_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-events_2.11\jars\util-events_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-function_2.11\jars\util-function_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-hashing_2.11\jars\util-hashing_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-jvm_2.11\jars\util-jvm_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-lint_2.11\jars\util-lint_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-logging_2.11\jars\util-logging_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-registry_2.11\jars\util-registry_2.11-6.37.0.jar;C:\Users\peter\.ivy2\cache\com.twitter\util-stats_2.11\jars\util-stats_2.11-6.37.0.jar;C:\Program Files (x86)\JetBrains\IntelliJ IDEA 2016.2\lib\idea_rt.jar" com.intellij.rt.execution.application.AppMain org.jetbrains.plugins.scala.testingSupport.scalaTest.ScalaTestRunner -s uk.co.xenonique.clients.cs.crowdfund.loan.CrowdSourceServerFeatureTest -showProgressMessages true -C org.jetbrains.plugins.scala.testingSupport.scalaTest.ScalaTestReporter
    Testing started at 9:03 AM ...
    Sep 13, 2016 8:03:19 AM com.twitter.finagle.http.HttpMuxer$$anonfun$4 apply
    INFO: HttpMuxer[/admin/metrics.json] = com.twitter.finagle.stats.MetricsExporter(<function1>)
    Sep 13, 2016 8:03:19 AM com.twitter.finagle.http.HttpMuxer$$anonfun$4 apply
    INFO: HttpMuxer[/admin/per_host_metrics.json] = com.twitter.finagle.stats.HostMetricsExporter(<function1>)
    
    An exception or error caused a run to abort. 
    java.lang.AbstractMethodError
        at org.scalatest.Assertions$class.$init$(Assertions.scala:1342)
        at com.twitter.inject.server.EmbeddedTwitterServer.<init>(EmbeddedTwitterServer.scala:77)
        at com.twitter.finatra.http.EmbeddedHttpServer.<init>(EmbeddedHttpServer.scala:54)
        at uk.co.xenonique.clients.cs.crowdfund.loan.CrowdSourceServerFeatureTest.<init>(CrowdSourceServerFeatureTest.scala:14)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
        at java.lang.Class.newInstance(Class.java:442)
        at org.scalatest.tools.Runner$.genSuiteConfig(Runner.scala:1422)
        at org.scalatest.tools.Runner$$anonfun$31.apply(Runner.scala:1236)
        at org.scalatest.tools.Runner$$anonfun$31.apply(Runner.scala:1235)
        at scala.collection.immutable.List.map(List.scala:273)
        at org.scalatest.tools.Runner$.doRunRunRunDaDoRunRun(Runner.scala:1235)
        at org.scalatest.tools.Runner$$anonfun$runOptionallyWithPassFailReporter$2.apply(Runner.scala:1011)
        at org.scalatest.tools.Runner$$anonfun$runOptionallyWithPassFailReporter$2.apply(Runner.scala:1010)
        at org.scalatest.tools.Runner$.withClassLoaderAndDispatchReporter(Runner.scala:1500)
        at org.scalatest.tools.Runner$.runOptionallyWithPassFailReporter(Runner.scala:1010)
        at org.scalatest.tools.Runner$.run(Runner.scala:850)
        at org.scalatest.tools.Runner.run(Runner.scala)
        at org.jetbrains.plugins.scala.testingSupport.scalaTest.ScalaTestRunner.runScalaTest2(ScalaTestRunner.java:138)
        at org.jetbrains.plugins.scala.testingSupport.scalaTest.ScalaTestRunner.main(ScalaTestRunner.java:28)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at com.intellij.rt.execution.application.AppMain.main(AppMain.java:147)
    
    
    Process finished with exit code 0

The embedded `TwitterServer` invokes a non-existent ScalaTest method. 
I spent a couple of hours attempting to resolve from dependencies.
It appears this Finatra / Finagle server is very sensitive to breakages from either ScalaTest or TwitterServer.
This is shame, because it looked like a good way to automate RESTful testings instead 
I resorted to Chrome / POSTMAN and manual testing to verify the API.

As alternative, I would have looked Apache HttpClient library, but I ran out of time

Peter Pilgrim
12 September 2016